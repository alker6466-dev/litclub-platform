<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>LitClub ‚Äî –û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–∏–≥–∏</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body data-page="meeting">
<header class="header">
  <div class="header-left">
    <div class="logo">
      <a href="index.html">LitClub</a>
    </div>

    <div class="header-social">
      <a href="https://t.me/" target="_blank" aria-label="Telegram">
        <i class="fa-brands fa-telegram"></i>
      </a>
      <a href="https://facebook.com/" target="_blank" aria-label="Facebook">
        <i class="fa-brands fa-facebook-f"></i>
      </a>
      <a href="https://instagram.com/" target="_blank" aria-label="Instagram">
        <i class="fa-brands fa-instagram"></i>
      </a>
      <a href="https://youtube.com/" target="_blank" aria-label="YouTube">
        <i class="fa-brands fa-youtube"></i>
      </a>
    </div>
  </div>

  <nav class="nav">
    <a href="index.html" class="nav-link">–ì–æ–ª–æ–≤–Ω–∞</a>
    <a href="clubs.html" class="nav-link">–ö–ª—É–±–∏</a>
    <a href="meeting.html" class="nav-link active">–û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è</a>
    <a href="profile.html" class="nav-link">–ü—Ä–æ—Ñ—ñ–ª—å</a>
    <a href="about.html" class="nav-link">–ü—Ä–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É</a>
  </nav>
</header>

<main class="container container-wide">
  <section class="section">
    <div class="meeting-header card">
      <div class="meeting-info">
        <h1><i class="fa-solid fa-book-open-reader"></i> –û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–∏–≥–∏ ¬´451¬∞ –∑–∞ –§–∞—Ä–µ–Ω–≥–µ–π—Ç–æ–º¬ª</h1>
        <p class="meeting-meta">
          <span>–ö–ª—É–±: <strong>–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞ &amp; Sci-Fi</strong></span> |
          <span>–î–∞—Ç–∞: <strong>10 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025</strong></span> |
          <span>–ü–æ—á–∞—Ç–æ–∫: <strong>19:00</strong></span>
        </p>
        <p class="meeting-desc">
          üìö –£ —Ü—å–æ–º—É –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—ñ —É—á–∞—Å–Ω–∏–∫–∏ –¥–∏—Å–∫—É—Ç—É—é—Ç—å –ø—Ä–æ —Å–≤—ñ—Ç, –¥–µ –∫–Ω–∏–≥–∏ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ,
          —ñ –ø—Ä–æ —Ç–µ, —á–æ–º—É –∑–Ω–∞–Ω–Ω—è ‚Äî —Ü–µ —Å–≤–æ–±–æ–¥–∞.
        </p>
      </div>
    </div>

    <div class="layout-2">
      <!-- –õ–Ü–í–ê –ß–ê–°–¢–ò–ù–ê: –ß–ê–¢ -->
      <div class="chat chat-modern">
        <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å: –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω—ñ + —Ç–µ–º–∞ + —Ç–∞–π–º–µ—Ä -->
        <div class="chat-top">
          <div class="pinned-block" id="pinned-block">
            <div class="pinned-header">
              <i class="fa-solid fa-thumbtack"></i>
              <span>–ó–∞–∫—Ä—ñ–ø–ª–µ–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</span>
            </div>
            <div class="pinned-list" id="pinned-list">
              <p class="pinned-empty">–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.</p>
            </div>
          </div>

          <div class="discussion-topbar">
            <div class="discussion-topic">
              <span class="topic-label">–ü–æ—Ç–æ—á–Ω–∞ —Ç–µ–º–∞:</span>
              <span id="current-topic" class="topic-text">
                –ß–∏ –º–æ–∂–µ –∑–Ω–∞–Ω–Ω—è –±—É—Ç–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–º?
              </span>
              <button id="edit-topic-btn" class="btn btn-small btn-outline topic-edit-btn">
                <i class="fa-solid fa-pen"></i>
              </button>
            </div>
            <div class="discussion-timer">
              <span class="timer-label">–î–æ –∫—ñ–Ω—Ü—è –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è:</span>
              <span id="timer-display" class="timer-display">25:00</span>
            </div>
          </div>
        </div>

        <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è -->
        <div id="messages" class="chat-messages">
          <div class="message other" data-id="m1">
            <div class="message-author">–Ü—Ä–∏–Ω–∞</div>
            <div class="message-text">
              –ú–µ–Ω—ñ –∑–¥–∞—î—Ç—å—Å—è, —â–æ –ë—Ä–µ–¥–±–µ—Ä—ñ –ø–æ–∫–∞–∑—É—î, —è–∫ —Å—É—Å–ø—ñ–ª—å—Å—Ç–≤–æ —Å–∞–º–µ –¥–æ–±—Ä–æ–≤—ñ–ª—å–Ω–æ –≤—ñ–¥–º–æ–≤–ª—è—î—Ç—å—Å—è –≤—ñ–¥ –∑–Ω–∞–Ω—å.
            </div>
            <div class="message-footer">
              <div class="message-time">19:02</div>
              <div class="message-actions">
                <button class="reaction-btn" data-reaction="heart">‚ù§Ô∏è <span>0</span></button>
                <button class="reaction-btn" data-reaction="fire">üî• <span>0</span></button>
                <button class="reaction-btn" data-reaction="idea">üí° <span>0</span></button>
                <button class="icon-btn pin-btn" title="–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏">
                  üìå
                </button>
                <button class="icon-btn quote-btn" title="–¶–∏—Ç—É–≤–∞—Ç–∏">
                  ‚ùù
                </button>
              </div>
            </div>
          </div>

          <div class="message other" data-id="m2">
            <div class="message-author">–ú–∞–∫—Å–∏–º</div>
            <div class="message-text">
              –¢–∞–∫! –Ü –≥–æ–ª–æ–≤–Ω–∏–π –≥–µ—Ä–æ–π ‚Äì —Ü–µ –ª—é–¥–∏–Ω–∞, —â–æ –Ω–∞—Ä–µ—à—Ç—ñ –ø—Ä–æ–∫–∏–Ω—É–ª–∞—Å—è. –í–æ–≥–æ–Ω—å —Ç—É—Ç –Ω–µ —Ç—ñ–ª—å–∫–∏ —Ä—É–π–Ω—É—î, –∞ –π –æ—á–∏—â–∞—î.
            </div>
            <div class="message-footer">
              <div class="message-time">19:04</div>
              <div class="message-actions">
                <button class="reaction-btn" data-reaction="heart">‚ù§Ô∏è <span>0</span></button>
                <button class="reaction-btn" data-reaction="fire">üî• <span>0</span></button>
                <button class="reaction-btn" data-reaction="idea">üí° <span>0</span></button>
                <button class="icon-btn pin-btn" title="–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏">
                  üìå
                </button>
                <button class="icon-btn quote-btn" title="–¶–∏—Ç—É–≤–∞—Ç–∏">
                  ‚ùù
                </button>
              </div>
            </div>
          </div>

          <div class="message me" data-id="m3">
            <div class="message-author">–í–ª–∞–¥ –ü—ñ–Ω—á—É–∫</div>
            <div class="message-text">
              –ê–±—Å–æ–ª—é—Ç–Ω–æ –∑–≥–æ–¥–µ–Ω. –¶–µ —Å–∏–º–≤–æ–ª –ø—Ä–æ–±—É–¥–∂–µ–Ω–Ω—è –ª—é–¥—Å—å–∫–æ—ó —Å–≤—ñ–¥–æ–º–æ—Å—Ç—ñ ‚Äî —ñ –±–æ—Ä–æ—Ç—å–±–∏ –∑ –±–∞–π–¥—É–∂—ñ—Å—Ç—é.
            </div>
            <div class="message-footer">
              <div class="message-time">19:05</div>
              <div class="message-actions">
                <button class="reaction-btn" data-reaction="heart">‚ù§Ô∏è <span>0</span></button>
                <button class="reaction-btn" data-reaction="fire">üî• <span>0</span></button>
                <button class="reaction-btn" data-reaction="idea">üí° <span>0</span></button>
                <button class="icon-btn pin-btn" title="–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏">
                  üìå
                </button>
                <button class="icon-btn quote-btn" title="–¶–∏—Ç—É–≤–∞—Ç–∏">
                  ‚ùù
                </button>
              </div>
            </div>
          </div>

          <div class="message other" data-id="m4">
            <div class="message-author">–û–ª–µ–≥</div>
            <div class="message-text">
              –ê —Å—Ü–µ–Ω–∞, –¥–µ –≥–µ—Ä–æ–π –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É—î –∫–Ω–∏–≥–∏ ‚Äî –æ–¥–Ω–∞ –∑ –Ω–∞–π—Å–∏–ª—å–Ω—ñ—à–∏—Ö. –í–æ–Ω–∞ –Ω–∞–≥–∞–¥—É—î, —â–æ –Ω–∞–≤—ñ—Ç—å —É —Ç–µ–º—Ä—è–≤—ñ —î –Ω–∞–¥—ñ—è.
            </div>
            <div class="message-footer">
              <div class="message-time">19:08</div>
              <div class="message-actions">
                <button class="reaction-btn" data-reaction="heart">‚ù§Ô∏è <span>0</span></button>
                <button class="reaction-btn" data-reaction="fire">üî• <span>0</span></button>
                <button class="reaction-btn" data-reaction="idea">üí° <span>0</span></button>
                <button class="icon-btn pin-btn" title="–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏">
                  üìå
                </button>
                <button class="icon-btn quote-btn" title="–¶–∏—Ç—É–≤–∞—Ç–∏">
                  ‚ùù
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –¥—ñ–π (–∑–∞–ª–∏—à–∏–º–æ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–∏—Å–∞—Ç–∏) -->
        <form id="message-form" class="chat-form">
          <input
            id="message-input"
            type="text"
            placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –¥—É–º–∫—É –ø—Ä–æ –∫–Ω–∏–≥—É..."
            autocomplete="off"
          />
          <button type="submit" class="btn btn-primary">
            <i class="fa-solid fa-paper-plane"></i> –ù–∞–¥—ñ—Å–ª–∞—Ç–∏
          </button>
        </form>
      </div>

      <!-- –ü–†–ê–í–ê –ß–ê–°–¢–ò–ù–ê: –°–ê–ô–î–ë–ê–† -->
      <aside class="sidebar sidebar-modern">
        <h2><i class="fa-solid fa-users"></i> –£—á–∞—Å–Ω–∏–∫–∏ –æ–Ω–ª–∞–π–Ω</h2>
        <ul class="user-list">
          <li><span class="user-status"></span> –Ü—Ä–∏–Ω–∞</li>
          <li><span class="user-status"></span> –ú–∞–∫—Å–∏–º</li>
          <li><span class="user-status"></span> –û–ª–µ–≥</li>
          <li><span class="user-status"></span> –í–ª–∞–¥ –ü—ñ–Ω—á—É–∫ (–≤–∏)</li>
        </ul>

        <div class="discussion-note">
          <p>
            üí¨ –û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–º–∏: <strong>¬´–ó–Ω–∞–Ω–Ω—è –ø—Ä–æ—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é¬ª</strong>.<br>
            –î—ñ–ª—ñ—Ç—å—Å—è –º–æ–º–µ–Ω—Ç–∞–º–∏, —è–∫—ñ –Ω–∞–π–±—ñ–ª—å—à–µ –≤–∞—Å –≤—Ä–∞–∑–∏–ª–∏.
          </p>
        </div>

        <div class="quote-day">
          <h3>‚ú® –¶–∏—Ç–∞—Ç–∞ –∑ –∫–Ω–∏–≥–∏</h3>
          <p>
            ¬´–°–ø–∞–ª—é–≤–∞—Ç–∏ –∫–Ω–∏–≥–∏ ‚Äî —Ü–µ –∑–ª–æ—á–∏–Ω –ø—Ä–æ—Ç–∏ –ø–∞–º‚Äô—è—Ç—ñ –ª—é–¥—Å—Ç–≤–∞.¬ª
          </p>
        </div>
      </aside>
    </div>
  </section>
</main>

<footer class="footer">
  <div class="footer-inner">
    <div class="footer-left">
      <div class="footer-logo">LitClub</div>
      <nav class="footer-nav">
        <a href="index.html">–ì–æ–ª–æ–≤–Ω–∞</a>
        <a href="clubs.html">–ö–ª—É–±–∏</a>
        <a href="meeting.html">–û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è</a>
        <a href="about.html">–ü—Ä–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É</a>
      </nav>
    </div>

    <div class="footer-right">
      <a href="mailto:info@litclub.ua" class="footer-contact-btn">–ö–û–ù–¢–ê–ö–¢–ò</a>
    </div>
  </div>

  <hr class="footer-line">

  <div class="footer-bottom">
    <div class="footer-social">
      <a href="#" aria-label="Telegram"><i class="fa-brands fa-telegram"></i></a>
      <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
      <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
      <a href="#" aria-label="YouTube"><i class="fa-brands fa-youtube"></i></a>
    </div>
    <p class="footer-copy">¬© 2025 LitClub.</p>
  </div>

  <button class="scroll-top" id="scrollTopBtn" aria-label="–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –≤–≥–æ—Ä—É">
    <i class="fa-solid fa-chevron-up"></i>
  </button>
</footer>

<!-- –°–∫—Ä–æ–ª –≤–≥–æ—Ä—É -->
<script>
  const scrollBtn = document.getElementById('scrollTopBtn');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 300) scrollBtn.classList.add('scroll-top--visible');
    else scrollBtn.classList.remove('scroll-top--visible');
  });
  scrollBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
</script>

<!-- –õ–û–ì–Ü–ö–ê –¢–ï–ú–ò, –¢–ê–ô–ú–ï–†–ê, –†–ï–ê–ö–¶–Ü–ô –¢–ê –ó–ê–ö–†–Ü–ü–õ–ï–ù–¨ -->
<script>
(function () {
  const STORAGE_TOPIC = 'litclub_meeting_topic';
  const STORAGE_TIMER_END = 'litclub_meeting_timer_end';
  const STORAGE_PINNED = 'litclub_meeting_pinned';
  const STORAGE_REACTIONS = 'litclub_meeting_reactions';

  document.addEventListener('DOMContentLoaded', () => {
    const messagesEl = document.getElementById('messages');
    const topicEl = document.getElementById('current-topic');
    const editTopicBtn = document.getElementById('edit-topic-btn');
    const timerDisplay = document.getElementById('timer-display');
    const pinnedList = document.getElementById('pinned-list');
    const pinnedBlock = document.getElementById('pinned-block');
    const messageInput = document.getElementById('message-input');
    const messageForm = document.getElementById('message-form');

    let timerEnded = false;

    /* ==== –¢–ï–ú–ê –û–ë–ì–û–í–û–†–ï–ù–ù–Ø ==== */

    function loadTopic() {
      try {
        const saved = localStorage.getItem(STORAGE_TOPIC);
        if (saved && topicEl) topicEl.textContent = saved;
      } catch (e) {}
    }

    function saveTopic(text) {
      try {
        localStorage.setItem(STORAGE_TOPIC, text);
      } catch (e) {}
    }

    if (editTopicBtn && topicEl) {
      editTopicBtn.addEventListener('click', () => {
        const current = topicEl.textContent.trim();
        const next = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É —Ç–µ–º—É –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è:', current);
        if (next && next.trim()) {
          topicEl.textContent = next.trim();
          saveTopic(next.trim());
        }
      });
    }

    loadTopic();

    /* ==== –¢–ê–ô–ú–ï–† –î–û –ö–Ü–ù–¶–Ø –û–ë–ì–û–í–û–†–ï–ù–ù–Ø ==== */

    function loadEndTime() {
      try {
        const saved = localStorage.getItem(STORAGE_TIMER_END);
        const now = Date.now();
        if (saved) {
          const t = parseInt(saved, 10);
          if (!isNaN(t) && t > now) return t;
        }
      } catch (e) {}
      // –Ø–∫—â–æ –Ω–µ–º–∞—î –∞–±–æ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏–π ‚Äî —Å—Ç–∞–≤–∏–º–æ –Ω–æ–≤—ñ 25 —Ö–≤–∏–ª–∏–Ω
      const end = Date.now() + 25 * 60 * 1000;
      try {
        localStorage.setItem(STORAGE_TIMER_END, String(end));
      } catch (e) {}
      return end;
    }

    let endTime = loadEndTime();

    function addSystemMessage(text) {
      if (!messagesEl) return;
      const msg = document.createElement('div');
      msg.classList.add('message', 'system');
      msg.innerHTML = '<div class="message-text">' + text + '</div>';
      messagesEl.appendChild(msg);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function updateTimer() {
      const now = Date.now();
      const diff = endTime - now;
      if (!timerDisplay) return;

      if (diff <= 0) {
        timerDisplay.textContent = '00:00';
        timerDisplay.classList.add('timer-ended');
        if (!timerEnded) {
          timerEnded = true;
          addSystemMessage('‚è∞ –û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.');
        }
        return;
      }

      const totalSec = Math.floor(diff / 1000);
      const min = String(Math.floor(totalSec / 60)).padStart(2, '0');
      const sec = String(totalSec % 60).padStart(2, '0');
      timerDisplay.textContent = min + ':' + sec;
    }

    updateTimer();
    setInterval(updateTimer, 1000);

    /* ==== –†–ï–ê–ö–¶–Ü–á ==== */

    let reactions = {};
    try {
      const saved = localStorage.getItem(STORAGE_REACTIONS);
      reactions = saved ? JSON.parse(saved) : {};
    } catch (e) {
      reactions = {};
    }

    function saveReactions() {
      try {
        localStorage.setItem(STORAGE_REACTIONS, JSON.stringify(reactions));
      } catch (e) {}
    }

    function applyReactions() {
      const allMessages = messagesEl.querySelectorAll('.message[data-id]');
      allMessages.forEach(msg => {
        const id = msg.dataset.id;
        const btns = msg.querySelectorAll('.reaction-btn');
        btns.forEach(btn => {
          const type = btn.dataset.reaction;
          const span = btn.querySelector('span');
          const count = reactions[id] && reactions[id][type] ? reactions[id][type] : 0;
          if (span) span.textContent = count;
        });
      });
    }

    applyReactions();

    messagesEl.addEventListener('click', (e) => {
      const target = e.target;

      // –†–µ–∞–∫—Ü—ñ—ó
      if (target.closest('.reaction-btn')) {
        const btn = target.closest('.reaction-btn');
        const msg = btn.closest('.message[data-id]');
        if (!msg) return;
        const id = msg.dataset.id;
        const type = btn.dataset.reaction;
        if (!reactions[id]) reactions[id] = { heart: 0, fire: 0, idea: 0 };
        reactions[id][type] = (reactions[id][type] || 0) + 1;
        saveReactions();
        applyReactions();
      }

      // –¶–∏—Ç—É–≤–∞–Ω–Ω—è
      if (target.closest('.quote-btn')) {
        const msg = target.closest('.message[data-id]');
        if (!msg || !messageInput) return;
        const textEl = msg.querySelector('.message-text');
        const authorEl = msg.querySelector('.message-author');
        const text = textEl ? textEl.textContent.trim() : '';
        const author = authorEl ? authorEl.textContent.trim() : '–£—á–∞—Å–Ω–∏–∫';
        messageInput.value = '¬´' + text + '¬ª ‚Äî ' + author + '. ';
        messageInput.focus();
        messagesEl.scrollTop = messagesEl.scrollHeight;
      }
    });

    /* ==== –ó–ê–ö–†–Ü–ü–õ–ï–ù–Ü –ü–û–í–Ü–î–û–ú–õ–ï–ù–ù–Ø ==== */

    let pinned = [];
    try {
      const savedPinned = localStorage.getItem(STORAGE_PINNED);
      pinned = savedPinned ? JSON.parse(savedPinned) : [];
    } catch (e) {
      pinned = [];
    }

    function savePinned() {
      try {
        localStorage.setItem(STORAGE_PINNED, JSON.stringify(pinned));
      } catch (e) {}
    }

    function renderPinned() {
      if (!pinnedList) return;
      pinnedList.innerHTML = '';
      if (!pinned || pinned.length === 0) {
        const p = document.createElement('p');
        p.classList.add('pinned-empty');
        p.textContent = '–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.';
        pinnedList.appendChild(p);
        return;
      }

      pinned.forEach(item => {
        const div = document.createElement('div');
        div.classList.add('pinned-item');
        div.dataset.id = item.id;
        div.innerHTML = `
          <div class="pinned-item-text">¬´${item.text}¬ª</div>
          <div class="pinned-item-meta">
            <span>${item.author}</span>
            <button class="icon-btn unpin-btn" title="–í—ñ–¥–∫—Ä—ñ–ø–∏—Ç–∏">‚úñ</button>
          </div>
        `;
        pinnedList.appendChild(div);
      });
    }

    renderPinned();

    messagesEl.addEventListener('click', (e) => {
      const target = e.target;

      // –ó–∞–∫—Ä—ñ–ø–∏—Ç–∏
      if (target.closest('.pin-btn')) {
        const msg = target.closest('.message[data-id]');
        if (!msg) return;
        const id = msg.dataset.id;
        const textEl = msg.querySelector('.message-text');
        const authorEl = msg.querySelector('.message-author');
        const text = textEl ? textEl.textContent.trim() : '';
        const author = authorEl ? authorEl.textContent.trim() : '–£—á–∞—Å–Ω–∏–∫';

        if (!pinned.find(p => p.id === id)) {
          pinned.push({ id, text, author });
          savePinned();
          renderPinned();
          msg.classList.add('message-pinned');
        }
      }
    });

    if (pinnedBlock) {
      pinnedBlock.addEventListener('click', (e) => {
        const target = e.target;
        if (target.closest('.unpin-btn')) {
          const item = target.closest('.pinned-item');
          if (!item) return;
          const id = item.dataset.id;
          pinned = pinned.filter(p => p.id !== id);
          savePinned();
          renderPinned();
          const msg = messagesEl.querySelector('.message[data-id="' + id + '"]');
          if (msg) msg.classList.remove('message-pinned');
        }
      });
    }

    // –ü—ñ–¥—Å–≤—ñ—Ç–∏—Ç–∏ –≤–∂–µ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω—ñ
    pinned.forEach(p => {
      const msg = messagesEl.querySelector('.message[data-id="' + p.id + '"]');
      if (msg) msg.classList.add('message-pinned');
    });

    /* ==== –í–Ü–î–ü–†–ê–í–ö–ê –ü–û–í–Ü–î–û–ú–õ–ï–ù–ù–Ø (–ª–æ–∫–∞–ª—å–Ω–æ) ==== */

    if (messageForm && messageInput && messagesEl) {
      messageForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const text = messageInput.value.trim();
        if (!text) return;

        const id = 'm' + Date.now();
        const div = document.createElement('div');
        div.classList.add('message', 'me');
        div.dataset.id = id;
        const time = new Date();
        const timeStr = String(time.getHours()).padStart(2, '0') + ':' +
                        String(time.getMinutes()).padStart(2, '0');

        div.innerHTML = `
          <div class="message-author">–í–ª–∞–¥ –ü—ñ–Ω—á—É–∫</div>
          <div class="message-text">${text}</div>
          <div class="message-footer">
            <div class="message-time">${timeStr}</div>
            <div class="message-actions">
              <button class="reaction-btn" data-reaction="heart">‚ù§Ô∏è <span>0</span></button>
              <button class="reaction-btn" data-reaction="fire">üî• <span>0</span></button>
              <button class="reaction-btn" data-reaction="idea">üí° <span>0</span></button>
              <button class="icon-btn pin-btn" title="–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏">üìå</button>
              <button class="icon-btn quote-btn" title="–¶–∏—Ç—É–≤–∞—Ç–∏">‚ùù</button>
            </div>
          </div>
        `;
        messagesEl.appendChild(div);
        messagesEl.scrollTop = messagesEl.scrollHeight;
        messageInput.value = '';
      });
    }
  });
})();
</script>

</body>
</html>
